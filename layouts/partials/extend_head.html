<!-- LXGW WenKai（霞鹜文楷） -->
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css">

<!-- 阅读进度条（克制、有用） -->
<style>
  #readProgress {
    position: fixed;
    left: 0;
    top: 0;
    height: 2px;
    width: 0%;
    background: var(--primary);
    z-index: 99999;
    opacity: .9;
  }

  /* ========== 小蝙蝠回到顶部（跟随主题色 + 轻微扇翅膀） ========== */
  #batTop{
    position: fixed;
    right: 22px;
    bottom: 22px;
    width: 42px;
    height: 42px;
    border-radius: 999px;
    background: var(--entry);
    color: var(--secondary);       /* 跟随主题（克制）；想更显眼用 --primary */
    border: 1px solid var(--border-soft);
    box-shadow: 0 12px 28px rgba(0,0,0,.12);
    display: none;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 9999;
    transition: transform .2s ease, opacity .2s ease;
  }

  #batTop:hover{
    transform: translateY(-2px);
  }

  /* 翅膀：旋转基点（决定“扇翅膀”的自然程度） */
  .bat-icon .wing.left  { transform-origin: 90% 50%; }
  .bat-icon .wing.right { transform-origin: 10% 50%; }

  /* hover：轻微扇一下（克制） */
  #batTop:hover .wing.left  { transform: rotate(-6deg); }
  #batTop:hover .wing.right { transform: rotate(6deg); }

  /* 动画：短、干净 */
  .bat-icon .wing{
    transition: transform .18s ease;
  }
</style>

<div id="readProgress"></div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    /* ---------- 阅读进度条 ---------- */
    const bar = document.getElementById("readProgress");
    const onScroll = () => {
      const h = document.documentElement;
      const max = h.scrollHeight - h.clientHeight;
      const p = max > 0 ? (h.scrollTop / max) * 100 : 0;
      bar.style.width = p.toFixed(2) + "%";
    };
    window.addEventListener("scroll", onScroll, { passive: true });
    onScroll();

    /* ---------- 小蝙蝠：回到顶部（内联SVG，才能跟随主题色） ---------- */
    const btn = document.createElement("div");
    btn.id = "batTop";
    btn.setAttribute("title", "回到顶部");
    btn.setAttribute("aria-label", "回到顶部");
    btn.innerHTML = `
<svg xmlns="http://www.w3.org/2000/svg"
     viewBox="0 0 64 64"
     width="22" height="22"
     class="bat-icon"
     role="img" aria-label="bat">
  <!-- 左翼 -->
  <g class="wing left" fill="currentColor">
    <path d="M6 34c6.8-1.5 11.5-4.8 14.4-9.3
             1-1.6 3.4-1.1 3.7.8l1.1 6.7
             c.1.6-.1 1.1-.5 1.5
             -1.2 1.1-2.7 2.2-4.5 3.2
             -1.3.7-2.2 2-2.3 3.5
             l-.1 2.1
             c-3-2-6.7-2.2-11.8-1.1
             -.9.2-1.6-.6-1.4-1.5
             l.6-3.1
             c.2-1 .2-2-.2-2.8
             L4.5 35
             c-.6-1 .3-2.2 1.5-2z"/>
  </g>

  <!-- 右翼 -->
  <g class="wing right" fill="currentColor">
    <path d="M58 34c-6.8-1.5-11.5-4.8-14.4-9.3
             -1-1.6-3.4-1.1-3.7.8l-1.1 6.7
             c-.1.6.1 1.1.5 1.5
             1.2 1.1 2.7 2.2 4.5 3.2
             1.3.7 2.2 2 2.3 3.5
             l.1 2.1
             c3-2 6.7-2.2 11.8-1.1
             .9.2 1.6-.6 1.4-1.5
             l-.6-3.1
             c-.2-1-.2-2 .2-2.8
             l.8-1.4
             c.6-1-.3-2.2-1.5-2z"/>
  </g>

  <!-- 头 + 身体 -->
  <g fill="currentColor">
    <path d="M32 24c-3.2 0-5.8 2.6-5.8 5.8
             S28.8 35.6 32 35.6
             s5.8-2.6 5.8-5.8
             S35.2 24 32 24z"/>
    <path d="M27.5 35.2
             c1.3 2.8 3.7 5 4.5 8.3
             .2.9.9 1.5 2 1.5
             s1.8-.6 2-1.5
             c.8-3.3 3.2-5.5 4.5-8.3
             -1.8 1-4.2 1.8-6.5 1.8
             s-4.7-.8-6.5-1.8z"/>
  </g>

  <!-- 眼睛 -->
  <g fill="white" opacity=".9">
    <circle cx="29.6" cy="29.6" r="1"/>
    <circle cx="34.4" cy="29.6" r="1"/>
  </g>
</svg>
`;
    document.body.appendChild(btn);

    const toggleBat = () => {
      btn.style.display = window.scrollY > 320 ? "flex" : "none";
    };
    window.addEventListener("scroll", toggleBat, { passive: true });
    toggleBat();

    btn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  });
</script>

